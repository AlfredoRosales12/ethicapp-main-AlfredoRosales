"use strict";var adpp=angular.module("SesList",["ui.bootstrap","btford.socket-io"]);adpp.factory("$socket",["socketFactory",function(b){return b()}]),adpp.controller("SesListController",["$scope","$http","$socket","$uibModal",function(c,d,e,a){var g=c;g.sessions=[],g.sesOpen=!1,g.invCode="",g.showCodeError=!1,g.routes={L:"to-visor",M:"to-semantic",S:"to-select",E:"to-differential",R:"to-role"},g.init=function(){g.updateSessions(),e.on("stateChange",function(b){console.log("SOCKET.IO",b),g.updateSessions()}),g.showName()},g.showName=function(){d.post("get-my-name").success(function(b){g.username=b.name,g.mylang=b.lang})},g.updateSessions=function(){d({url:"get-session-list",method:"post"}).success(function(b){g.sessions=b})},g.openSes=function(){g.sesOpen=!0},g.enterCode=function(){if(g.checkCode(g.invCode.toLowerCase())){var b={code:g.invCode.toLowerCase()};d.post("enter-session-code",b).success(function(b){"ok"==b.status?window.location.replace(b.redirect):a.open({template:"<div><div class=\"modal-header\"><h4>Error</h4></div><div class=\"modal-body\"><p>El c\xF3digo ingresado no es v\xE1lido</p></div></div>"})})}},g.checkCode=function(c){console.log(g.sessions,c);var d=g.sessions.find(function(a){return a.code==c});if(console.log(d),null==d)return!0;var a=g.routes[d.type]+"?sesid="+d.id;return window.location.replace(a),!1},g.changeLang=function(){var b="english"==g.mylang?"spanish":"english";d.post("update-lang",{lang:b}).success(function(){g.showName()})},g.init()}]);
