"use strict";var adpp=angular.module("SesList",["ui.bootstrap","btford.socket-io"]);adpp.factory("$socket",["socketFactory",function(a){return a()}]),adpp.controller("SesListController",["$scope","$http","$socket","$uibModal",function(a,b,c,d){var f=a;f.sessions=[],f.sesOpen=!1,f.invCode="",f.showCodeError=!1,f.routes={L:"to-visor",M:"to-semantic",S:"to-select",E:"to-differential"},f.init=function(){f.updateSessions(),c.on("stateChange",function(g){console.log("SOCKET.IO",g),f.updateSessions()}),f.showName()},f.showName=function(){b.post("get-my-name").success(function(g){f.username=g.name,f.mylang=g.lang})},f.updateSessions=function(){b({url:"get-session-list",method:"post"}).success(function(g){f.sessions=g})},f.openSes=function(){f.sesOpen=!0},f.enterCode=function(){if(f.checkCode(f.invCode.toLowerCase())){var g={code:f.invCode.toLowerCase()};b.post("enter-session-code",g).success(function(h){"ok"==h.status?window.location.replace(h.redirect):d.open({template:"<div><div class=\"modal-header\"><h4>Error</h4></div><div class=\"modal-body\"><p>El c\\xF3digo ingresado no es v\\xE1lido</p></div></div>"})})}},f.checkCode=function(g){var h=f.sessions.find(function(j){return j.code==g});if(null==h)return!0;var i=routes[h.type]+"?sesid="+h.id;return window.location.replace(i),!1},f.changeLang=function(){var g="english"==f.mylang?"spanish":"english";b.post("update-lang",{lang:g}).success(function(){f.showName()})},f.init()}]);
